<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Browse by Model - Jake Troubleshoots</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <a href="index.html" class="site-logo">
    <img src="images/logo.png" alt="Jake Troubleshoots Logo" class="site-icon">
    <span class="logo-text">Jake Troubleshoots</span>
  </a>

  <nav>
    <a href="index.html">Home</a>
    <a href="guides.html">Guides</a>
    <a href="search.html">Search</a>
    <a href="vendors.html">Vendors</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<section class="hero">
  <h2>Browse Guides by Model</h2>
  <p>Find troubleshooting guides organized by equipment model.</p>

    <!-- Action buttons -->
  <div style="margin-top:20px; display:flex; justify-content:center; gap:12px; flex-wrap:wrap;">
    <a href="guides.html" class="hero-button">Browse All Guides</a>
  </div>
</section>

<section class="browse-section">
  <h3>Models</h3>
  <div class="letter-filter">
  <span class="filter-letter active" data-letter="all">All</span>
  <span class="filter-letter" data-letter="A">A</span>
  <span class="filter-letter" data-letter="B">B</span>
  <span class="filter-letter" data-letter="C">C</span>
  <span class="filter-letter" data-letter="D">D</span>
  <span class="filter-letter" data-letter="E">E</span>
  <span class="filter-letter" data-letter="F">F</span>
  <span class="filter-letter" data-letter="G">G</span>
  <span class="filter-letter" data-letter="H">H</span>
  <span class="filter-letter" data-letter="I">I</span>
  <span class="filter-letter" data-letter="J">J</span>
  <span class="filter-letter" data-letter="K">K</span>
  <span class="filter-letter" data-letter="L">L</span>
  <span class="filter-letter" data-letter="M">M</span>
  <span class="filter-letter" data-letter="N">N</span>
  <span class="filter-letter" data-letter="O">O</span>
  <span class="filter-letter" data-letter="P">P</span>
  <span class="filter-letter" data-letter="Q">Q</span>
  <span class="filter-letter" data-letter="R">R</span>
  <span class="filter-letter" data-letter="S">S</span>
  <span class="filter-letter" data-letter="T">T</span>
  <span class="filter-letter" data-letter="U">U</span>
  <span class="filter-letter" data-letter="V">V</span>
  <span class="filter-letter" data-letter="W">W</span>
  <span class="filter-letter" data-letter="X">X</span>
  <span class="filter-letter" data-letter="Y">Y</span>
  <span class="filter-letter" data-letter="Z">Z</span>
</div>
  <div id="model-buttons" class="browse-buttons">
    <!-- Buttons injected here dynamically -->
  </div>
</section>

<section id="guides-grid" class="guides-grid" style="padding:40px; display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:20px;">
  <!-- Guide cards injected dynamically -->
</section>

<footer>
  <p>Contact: <a href="mailto:contact@jaketroubleshoots.com" style="color:#8fff00;">contact@jaketroubleshoots.com</a></p>
  <p>Guides intended for trained personnel only.</p>
  <p>© 2026 Jake Troubleshoots</p>
</footer>

<script>
(async function() {
  try {
    const res = await fetch('data/guides.json');
    if (!res.ok) throw new Error('Could not load guides.json');
    const jsonData = await res.json();

    // Resolve guides if jsonData is a list of files
    const allGuides = Array.isArray(jsonData) && typeof jsonData[0] === 'string'
      ? (await Promise.all(jsonData.map(file => fetch(file).then(r => r.json())))).flat()
      : jsonData;

    const container = document.getElementById('guides-grid');
    const buttonsContainer = document.getElementById('model-buttons'); // change to #manufacturer-buttons or #asset-buttons on other pages

    if (!container || !buttonsContainer) throw new Error('Required containers not found');

    // Unique items (models/manufacturers/asset types)
    const items = [...new Set(allGuides.map(g => g.model))].sort(); // change g.model → g.manufacturer / g.assetType on other pages

    // Create buttons
    items.forEach(item => {
      const btn = document.createElement('a');
      btn.href = '#';
      btn.textContent = item;
      btn.classList.add('browse-button');
      btn.addEventListener('click', e => {
        e.preventDefault();
        showGuidesByItem(item);
      });
      buttonsContainer.appendChild(btn);
    });

    // Letter filter
    const letters = document.querySelectorAll('.filter-letter');
    letters.forEach(letter => {
      letter.addEventListener('click', () => {
        const selected = letter.dataset.letter.toLowerCase();

        // Highlight active letter
        letters.forEach(l => l.classList.remove('active'));
        letter.classList.add('active');

        // Clear grid
        container.innerHTML = '';

        // Filter buttons
        const buttons = document.querySelectorAll(buttonsContainer.querySelectorAll('.browse-button'));
        buttons.forEach(btn => {
          const name = btn.textContent.toLowerCase();
          btn.style.display = (selected === 'all' || name.startsWith(selected)) ? '' : 'none';
        });

        // Click first visible button if exists
        const firstVisible = Array.from(buttons).find(b => b.style.display !== 'none');
        if (firstVisible) firstVisible.click();
      });
    });

    // Show guides by selected item
    function showGuidesByItem(item) {
      container.innerHTML = '';
      const filtered = allGuides
        .filter(g => g.model === item) // change g.model → g.manufacturer / g.assetType on other pages
        .sort((a, b) => a.title.localeCompare(b.title));

      filtered.forEach(guide => {
        const card = document.createElement('a');
        card.href = guide.url;
        card.classList.add('guide-card');

        card.innerHTML = `
          <div class="card-content">
            <h3>${guide.title}</h3>
            <p>${guide.description}</p>
            <div class="badges">
              <span class="badge asset">${guide.assetType}</span>
              <span class="badge manufacturer">${guide.manufacturer}</span>
              <span class="badge model">${guide.model}</span>
            </div>
            <p class="date"><em>Date Added: ${guide.dateAdded}</em></p>
          </div>
        `;
        container.appendChild(card);
      });
    }

    // Optional: don’t auto-click first item
  } catch (err) {
    console.error('Guide load error:', err);
  }
})();
</script>

</body>
</html>
